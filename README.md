# BX24 - класс обертка над [REST API Bitrix24](https://dev.1c-bitrix.ru/rest_help/)

Конструктор класса принимает 1 обязательный параметр ```$portal```- адрес портала (если пишем код для приложения Битрикс24) или хандлер вебхука и один не обязательный ```$app``` - для указания того что API используем в рамках приложения Битрикс24 (по умолчанию, работает с вебхуком)
```php
$bx = BX24('https://systech.bitrix24.ru/', 1);
```
В классе реализованны 2 основных метода - call и batch

### Call - метод для одиночного вызова методов API 

```php
$method = 'crm.deal.get';
$params = ['id' => $id];
$bx->call($method, $params);
```
Возвращает результат вызова или ошибку с описанием
При использовании ```list``` методов API возвращает сразу все записи, без ограничения в 50 за раз

### Batch - пакетный метод обращения к API

```php
$Params[] = ['crm.deal.get' => ['id' => $id]];
$Params[] = ['crm.deal.list' => ['filter' => ['ASSIGNED_BY_ID' => '$result[0][ASSIGNED_BY_ID]']]];
$bx->batch($Params);
```
Возвращает результат всех методов API, переданных в качестве ключей массива ```$Params ``` или ошибки с описанием
Так же при формировании ``` $Params``` более 50 элементов, выполняет и возвращает все записи (но не будет соблюдаться номерация обращения к результатам предыдущих пакетов)

В классе предусмотренна задержка в 0,5 сек при непосрредственном обращении к API, дабы не словить ошибку превышения лимита 
